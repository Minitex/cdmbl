require 'test_helper'
module CDMBL
  describe OAIFilter do
    let(:headers) { ([{"identifier"=>"oai:reflections.mndigital.org:p16022coll44/0", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/1", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/2", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/3", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/4", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/5", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/6", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/7", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/8", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/9", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/10", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/11", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/12", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/13", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/14", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/15", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/16", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/17", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/18", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/19", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/20", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/21", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/22", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/23", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/24", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/25", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/26", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/27", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/28", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/29", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/30", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/31", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/32", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/33", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/34", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/35", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/36", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/37", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/38", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/39", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/40", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/41", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/42", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/43", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/44", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/45", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/46", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/47", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/48", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/49", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/50", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/51", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/52", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/53", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/54", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/55", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/56", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/57", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/58", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/59", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/60", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/61", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/62", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/63", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/64", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/65", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/66", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/67", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/68", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/69", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/70", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/71", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/72", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/73", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/74", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/75", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/76", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/77", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/78", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/79", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/80", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/81", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/82", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/83", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/84", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/85", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/86", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/87", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/88", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/89", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/90", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/91", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/92", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/93", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/96", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/99", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/102", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/105", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/108", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/111", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/114", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/117", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/120", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"identifier"=>"oai:reflections.mndigital.org:p16022coll44/123", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/0", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/1", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/2", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/3", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/4", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/5", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/6", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/7", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/8", "datestamp"=>"2014-06-24", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/9", "datestamp"=>"2014-04-07", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/10", "datestamp"=>"2014-04-07", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/11", "datestamp"=>"2014-04-07", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/12", "datestamp"=>"2014-04-07", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/13", "datestamp"=>"2014-04-07", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/14", "datestamp"=>"2014-04-07", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/15", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/16", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/17", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/18", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/19", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/20", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/21", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/22", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/23", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/24", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/25", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/26", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/27", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/28", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/29", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/30", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/31", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/32", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/33", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/34", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/35", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/36", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/37", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/38", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/39", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/40", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/41", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/42", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/43", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/44", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/45", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/46", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/47", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/48", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/49", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/50", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/51", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/52", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/53", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/54", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/55", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/56", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/57", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/58", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/59", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/60", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/61", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/62", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/63", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/64", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/65", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/66", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/67", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/68", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/69", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/70", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/71", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/72", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/73", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/74", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/75", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/76", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/77", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"status"=>"deleted", "identifier"=>"oai:reflections.mndigital.org:swede/78", "datestamp"=>"2012-02-08", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/79", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/80", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/81", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/82", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/83", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/84", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/85", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/86", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/87", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/88", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/89", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/90", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/91", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/92", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/93", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/94", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}, {"identifier"=>"oai:reflections.mndigital.org:swede/95", "datestamp"=>"2014-02-04", "setSpec"=>"swede"}]) }

    it 'returns all non-deleted records' do
      filter = OAIFilter.new(headers: headers)
      filter.updatables[1].must_equal({"identifier"=>"oai:reflections.mndigital.org:p16022coll44/1", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44", :collection=>"p16022coll44", :id=>"1"})
      filter.updatables[3].must_equal({"identifier"=>"oai:reflections.mndigital.org:p16022coll44/3", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44", :collection=>"p16022coll44", :id=>"3"})
      filter.updatables[5].must_equal({"identifier"=>"oai:reflections.mndigital.org:p16022coll44/5", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44", :collection=>"p16022coll44", :id=>"5"})
      filter.updatables[7].must_equal({"identifier"=>"oai:reflections.mndigital.org:p16022coll44/7", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44", :collection=>"p16022coll44", :id=>"7"})
      filter.updatables[9].must_equal({"identifier"=>"oai:reflections.mndigital.org:p16022coll44/9", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44", :collection=>"p16022coll44", :id=>"9"})
      filter.updatables[72].must_equal({"identifier"=>"oai:reflections.mndigital.org:p16022coll44/72", "datestamp"=>"2015-09-30", "setSpec"=>"p16022coll44", :collection=>"p16022coll44", :id=>"72"})
      filter.updatables[150].must_equal({"identifier"=>"oai:reflections.mndigital.org:swede/72", "datestamp"=>"2014-02-04", "setSpec"=>"swede", :collection=>"swede", :id=>"72"})
      filter.updatables.length.must_equal 171
    end
    it 'returns all deleted records' do
      filter = OAIFilter.new(headers: headers)
      filter.deletables.must_equal ["swede:0", "swede:1", "swede:2", "swede:7", "swede:16", "swede:19", "swede:20", "swede:21", "swede:24", "swede:25", "swede:28", "swede:29", "swede:30", "swede:31", "swede:44", "swede:46", "swede:48", "swede:51", "swede:52", "swede:54", "swede:56", "swede:59", "swede:60", "swede:64", "swede:68", "swede:70", "swede:73", "swede:76", "swede:78"]
      filter.deletables.length.must_equal 29
    end

  end
end